# Coze API Web UI 开发计划

## 项目背景

Coze API 项目提供了图片转视频的后端服务，但目前缺少直观的Web界面来测试和使用这些API功能。本计划旨在开发一个基于Vue.js的Web UI，方便用户在浏览器中直接访问和测试所有API功能。

## 现有API功能分析

通过对代码的分析，当前项目提供以下主要API功能：

### 上传功能 (/api/upload)
- `/api/upload/image` (POST): 上传图片文件
- `/api/upload/audio` (POST): 上传音频文件

### 视频管理 (/api/video)
- `/api/video/create` (POST): 创建视频，支持设置动画效果、转场效果和音频
- `/api/video/list` (GET): 获取已生成的视频列表
- `/api/video/get/<filename>` (GET): 获取特定的视频文件

### 其他API
- `/api/health` (GET): 健康检查，用于检测API服务状态
- `/uploads/<path>` (GET): 访问上传的文件
- `/videos/<path>` (GET): 访问生成的视频文件

## 数据模型

主要数据模型为`ImageItem`，包含以下属性：
- `id`: 唯一标识符
- `image_path`: 图片路径
- `text`: 文本描述
- `audio_path`: 关联音频文件路径
- `duration`: 在视频中显示的时长
- `animation`: 动画效果设置
- `order`: 在视频中的排序

## Web UI 需求

### 功能需求

1. **用户认证**（未来扩展）
   - 登录/注册界面
   - 用户会话管理

2. **主界面**
   - 导航菜单，包含所有主要功能区域
   - 状态指示器，显示API服务连接状态

3. **文件管理**
   - 文件列表展示
     - 图片文件：显示data/uploads目录下的所有图片
     - 音频文件：显示data/uploads和data/audio目录下的所有音频
     - 视频文件：显示data/output目录下的所有视频
   - 文件预览功能
     - 图片：缩略图和全屏预览
     - 音频：在线播放器
     - 视频：在线播放器
   - 文件操作
     - 删除文件
     - 下载文件
     - 批量操作支持

4. **上传管理**
   - 上传界面
     - 拖拽上传支持
     - 多文件同时上传
     - 上传进度显示
   - 已上传文件列表
     - 图片列表：显示data/uploads目录下的所有图片
     - 音频列表：合并显示data/uploads和data/audio目录下的所有音频
   - 文件来源标识
     - 清晰标识文件所在目录
     - 区分不同来源的音频文件
   - 上传历史记录
     - 记录上传时间
     - 显示文件大小和类型

5. **音频管理**
   - 音频列表
     - 显示所有音频文件（data/uploads和data/audio）
     - 音频来源标识
     - 音频信息展示（大小、时长等）
   - 音频创建
     - 文本转音频功能
     - 音频参数配置
     - 生成进度显示
   - 音频操作
     - 在线播放
     - 下载音频
     - 删除音频
     - 批量操作支持
   - 音频预览
     - 音频波形显示
     - 播放控制
     - 音量调节

6. **视频管理**
   - 视频列表
     - 显示所有生成的视频
     - 视频缩略图
     - 视频信息展示
   - 视频创建
     - 添加/排序图片到视频时间线
     - 为每张图片配置动画效果
     - 为每张图片关联音频
     - 设置转场效果参数
     - 设置视频输出参数
     - 视频创建进度显示
   - 视频操作
     - 在线播放
     - 下载视频
     - 删除视频
     - 批量操作支持
   - 视频预览
     - 视频播放器
     - 播放控制
     - 全屏支持
   - **计划增强功能**:
     - 组合动画效果：支持缩放+平移组合动画
     - 图片文本管理：为每张图片添加描述文本
     - 文本转音频：基于图片文本自动生成配音
     - 动画效果预览：即时预览设置的动画效果

7. **API测试面板**
   - 测试所有API端点的接口
   - 显示API请求和响应
   - 保存API测试历史

8. **系统状态**
   - 服务器健康状态监控
   - 资源使用情况（如果API提供相关数据）

### 技术需求

1. **前端框架**
   - Vue.js 3 + Vite
   - 组件库：Element Plus
   - 状态管理：Pinia
   - 路由：Vue Router

2. **API通信**
   - Axios用于API请求
   - 请求拦截器处理认证和错误
   - 合理的错误处理和用户反馈

3. **UI/UX设计**
   - 响应式布局，支持桌面和移动设备
   - 主题定制选项
   - 动画和过渡效果，提升用户体验

4. **数据持久化**
   - 本地存储API响应和设置
   - 实现草稿保存功能

5. **部署配置**
   - 开发环境配置
   - 生产环境构建优化
   - 与后端API服务集成配置

## 项目结构

```
web/
│
├── public/              # 静态资源
│   └── favicon.ico
│
├── src/                 # 源代码
│   ├── assets/          # 静态资源
│   │   ├── logo.png
│   │   └── styles/      # 样式文件
│   │
│   ├── components/      # 组件
│   │   ├── common/      # 通用组件
│   │   │   ├── AppHeader.vue    # 头部导航
│   │   │   ├── AppSidebar.vue   # 侧边栏
│   │   │   └── AppFooter.vue    # 页脚
│   │   │
│   │   ├── file/       # 文件相关组件
│   │   │   ├── FileList.vue     # 文件列表
│   │   │   ├── FilePreview.vue  # 文件预览
│   │   │   ├── FileUpload.vue   # 文件上传
│   │   │   └── FileActions.vue  # 文件操作
│   │   │
│   │   ├── audio/      # 音频相关组件
│   │   │   ├── AudioList.vue    # 音频列表
│   │   │   ├── AudioPlayer.vue  # 音频播放器
│   │   │   ├── AudioCreate.vue  # 音频创建
│   │   │   └── AudioActions.vue # 音频操作
│   │   │
│   │   ├── video/      # 视频相关组件
│   │   │   ├── VideoList.vue    # 视频列表
│   │   │   ├── VideoPlayer.vue  # 视频播放器
│   │   │   ├── VideoCreate.vue  # 视频创建
│   │   │   └── VideoActions.vue # 视频操作
│   │   │
│   │   └── preview/    # 预览相关组件
│   │       ├── ImagePreview.vue  # 图片预览
│   │       ├── AudioPreview.vue  # 音频预览
│   │       └── VideoPreview.vue  # 视频预览
│   │
│   ├── views/           # 页面
│   │   ├── Home.vue            # 主页
│   │   ├── FileManager.vue     # 文件管理
│   │   ├── UploadManager.vue   # 上传管理
│   │   ├── AudioManager.vue    # 音频管理
│   │   ├── VideoManager.vue    # 视频管理
│   │   └── ApiTest.vue         # API测试
│   │
│   ├── router/          # 路由配置
│   │   └── index.js
│   │
│   ├── store/           # 状态管理
│   │   ├── modules/
│   │   └── index.js
│   │
│   ├── api/             # API服务
│   │   ├── upload.js    # 上传相关API
│   │   ├── video.js     # 视频相关API
│   │   └── index.js     # API入口
│   │
│   ├── utils/           # 工具函数
│   │   ├── request.js   # Axios封装
│   │   └── validators.js # 验证函数
│   │
│   ├── App.vue          # 根组件
│   └── main.js          # 入口文件
│
├── .env                 # 环境变量
├── .env.development     # 开发环境变量
├── .env.production      # 生产环境变量
├── vite.config.js       # Vite配置文件
├── package.json         # 依赖配置
└── README.md            # 项目说明
```

## 开发任务分解

### 阶段1：项目搭建与基础功能（2天）

1. 项目初始化
   - 创建Vue项目
   - 配置路由和状态管理
   - 设置基础样式和主题

2. 基础组件开发
   - 页面布局组件
   - 导航菜单
   - 状态指示器
   - 通用表单组件

3. API服务层
   - 封装Axios请求
   - 实现API模块
   - 配置开发代理

### 阶段2：核心功能开发（6天）

1. 文件管理功能（2天）
   - 实现统一的文件列表组件
     - 支持多目录文件显示
     - 文件类型过滤
     - 文件来源标识
   - 开发文件预览功能
     - 图片预览组件
     - 音频播放器组件
     - 视频播放器组件
   - 实现文件操作功能
     - 删除和批量删除
     - 文件下载
     - 权限检查

2. 上传管理功能（1天）
   - 开发上传组件
     - 拖拽上传支持
     - 多文件上传
     - 进度显示
   - 实现已上传文件管理
     - 目录区分显示
     - 文件来源标识
     - 上传历史记录

3. 音频管理功能（1.5天）
   - 音频列表组件
     - 多目录音频显示
     - 音频信息展示
     - 来源标识
   - 音频创建功能
     - 文本转音频界面
     - 参数配置面板
     - 生成进度显示
   - 音频预览和操作
     - 音频播放器
     - 波形显示
     - 批量操作

4. 视频管理功能（1.5天）
   - 视频列表组件
     - 视频信息展示
     - 缩略图生成
     - 批量操作支持
   - 视频创建功能
     - 时间线编辑器
     - 动画效果配置
     - 参数设置面板
   - 视频预览和操作
     - 视频播放器
     - 下载和删除
     - 全屏预览

### 阶段3：高级功能与优化（3天）

1. API测试面板
   - 请求构建器
   - 响应查看器
   - 测试历史记录

2. 用户体验优化
   - 添加响应式支持
   - 优化加载和错误状态
   - 实现进度指示和反馈

3. 性能优化
   - 组件懒加载
   - 资源优化
   - 缓存策略

### 阶段4：API测试面板优化（2天）

1. 界面布局优化
   - 采用双栏布局设计
     - 左侧：API列表（30%宽度）
     - 右侧：请求构建器和响应查看器（70%宽度）
   - 移除历史记录功能，专注于API测试体验

2. API列表增强
   - 简化API列表显示，仅展示API名称
   - 添加API详情弹窗功能
     - 基本信息：URL、请求方式、API描述
     - 参数说明：请求参数、响应格式
     - 使用示例：示例请求和响应
     - 错误码说明：可能的错误情况
     - 注意事项：使用限制、注意点等
   - 添加"使用"按钮，一键填充请求构建器

3. 请求构建器优化
   - 优化参数输入界面
     - 添加参数验证和提示
     - 支持文件上传参数
     - JSON编辑器增强（格式化、语法高亮）
   - 添加请求预设功能
     - 保存常用参数组合
     - 快速填充表单

4. 响应查看器增强
   - 优化响应数据展示
     - JSON格式化和语法高亮
     - 图片/视频等媒体文件预览
   - 添加响应分析功能
     - 响应时间统计
     - 状态码说明
     - 错误提示优化

### 阶段5：测试与部署（1天）

1. 测试
   - 功能测试
   - 兼容性测试
   - 性能测试

2. 文档
   - 用户使用文档
   - 开发文档更新

3. 部署
   - 构建生产版本
   - 配置与后端集成

## 技术选型详情

1. **核心框架**
   - Vue.js 3.x：使用Composition API，更好的类型支持和性能
   - Vite：快速的开发服务器和构建工具

2. **UI组件库**
   - Element Plus：成熟的Vue 3组件库，提供丰富的UI组件

3. **状态管理**
   - Pinia：轻量且类型安全的状态管理，Vue 3官方推荐

4. **HTTP客户端**
   - Axios：功能丰富的HTTP客户端，支持拦截器和请求配置

5. **工具库**
   - Lodash：提供实用的JavaScript工具函数
   - Day.js：轻量级日期处理库

6. **开发工具**
   - ESLint：代码质量检查
   - Prettier：代码格式化
   - TypeScript：类型检查和增强开发体验

## 开发进度记录

### 已完成
- ✅ 项目初始化
- ✅ 路由配置
- ✅ API服务层开发
- ✅ 状态管理配置
- ✅ 基础UI组件开发
  - ✅ 应用布局
  - ✅ 顶部导航栏
  - ✅ 侧边菜单
  - ✅ 首页视图
- ✅ 上传功能实现
  - ✅ 图片上传组件
  - ✅ 音频上传组件
  - ✅ 上传列表与预览
- ✅ 环境配置与部署文档
  - ✅ 开发环境配置
  - ✅ 生产环境配置
  - ✅ 部署指南文档
- ✅ 视频创建功能
  - ✅ 图片时间线组件
  - ✅ 动画效果配置面板
  - ✅ 转场效果选择器
  - ✅ 音频关联与预览
  - ✅ 参数设置面板
- ✅ 视频管理功能
  - ✅ 视频列表组件
  - ✅ 视频播放器组件
  - ✅ 视频详情组件
- ✅ 视频功能增强 (UI部分)
  - ✅ 组合动画效果配置界面
  - ✅ 图片文本设置界面
  - ✅ 动画效果预览界面
  - ✅ 动画预设功能
- ✅ 音频创建功能
  - ✅ 文本转音频界面
  - ✅ 音频参数配置
  - ✅ 音频预览与保存
  - ✅ 文本模板管理
- ✅ API测试面板
  - ✅ 请求构建器
    - ✅ 支持多种HTTP方法
    - ✅ 请求头和参数配置
    - ✅ JSON和Form Data支持
  - ✅ 响应查看器
    - ✅ 状态码和响应时间显示
    - ✅ 响应体格式化和原始显示
    - ✅ 响应头查看
  - ✅ 历史记录管理
    - ✅ 历史记录列表
    - ✅ 搜索和筛选
    - ✅ 请求重放功能
  - ⬜ 接口列表增强
    - ⬜ 显示所有可用API接口
    - ⬜ 接口分类展示
    - ⬜ 点击自动填充请求信息
    - ⬜ 接口参数说明
    - ⬜ 示例请求和响应

### 待开始
- ⬜ 文件管理功能优化
  - ⬜ 实现多目录文件列表展示
    - ⬜ 图片文件显示data/uploads目录
    - ⬜ 音频文件显示data/uploads和data/audio目录
    - ⬜ 视频文件显示data/output目录
  - ⬜ 添加文件来源标识
  - ⬜ 优化文件预览功能
  - ⬜ 完善批量操作功能

- ⬜ 上传管理功能增强
  - ⬜ 优化已上传文件列表
    - ⬜ 区分显示不同目录的文件
    - ⬜ 添加文件来源标识
  - ⬜ 完善上传历史记录
    - ⬜ 记录上传时间和文件信息
    - ⬜ 支持历史记录查询和筛选
  - ⬜ 增强文件预览功能
    - ⬜ 优化音频播放器
    - ⬜ 完善图片预览

- ⬜ 视频功能增强 (API集成部分)
  - ⬜ 完成图片文本生成音频后端集成
  - ⬜ 组合动画效果后端处理
  - ⬜ 预览动画实时渲染优化

- ⬜ 性能优化
  - ⬜ 文件列表加载优化
  - ⬜ 图片预览性能优化
  - ⬜ 音频播放优化
  - ⬜ 组件懒加载实现

- ⬜ 测试与部署
  - ⬜ 功能测试
  - ⬜ 性能测试
  - ⬜ 部署文档更新

## 风险与挑战

1. **API兼容性**：需确保Web UI与后端API完全兼容，包括请求格式和响应处理。
2. **文件处理**：处理大型文件上传和视频处理可能带来性能挑战。
3. **动画效果配置**：需要设计直观易用的界面来配置复杂的动画参数。
4. **多浏览器兼容性**：确保在各主流浏览器中的一致体验。

## 未来扩展

1. **用户认证系统**：实现基于JWT的用户认证。
2. **项目管理**：允许用户创建和管理多个视频项目。
3. **更丰富的视频编辑**：添加更多高级视频编辑功能。
4. **协作功能**：支持多用户协作编辑视频项目。
5. **数据分析**：添加使用统计和分析功能。

## 视频功能增强计划

基于现有视频创建和管理功能，计划增加以下增强特性：

### 1. 组合动画效果实现

目前系统已支持基础的缩放、平移、旋转等动画效果，下一步将实现：

- **组合动画配置面板**：在现有动画效果配置基础上，添加"组合动画"选项
- **参数联动控制**：缩放和平移参数的联动调整，确保视觉效果和谐
- **多阶段动画**：支持设置动画的多个阶段，如先缩放后平移
- **曲线控制**：添加动画曲线编辑器，控制动画的缓动效果
- **动效预设**：提供常用组合动画效果的预设选项

### 2. 图片文本与音频生成集成

将利用后端已实现的文本转音频功能，在前端实现：

- **图片文本编辑器**：为每张图片添加文本描述输入框
- **文本模板系统**：提供常用文本模板，便于快速添加
- **音频自动生成**：基于图片文本一键生成对应音频
- **音频参数控制**：提供语速、音调、语言等参数设置
- **配音与时长同步**：自动调整图片显示时长与生成的音频时长匹配

### 3. 动画效果预览

增加动画效果的即时预览功能：

- **单图预览**：在编辑单张图片动画效果时提供实时预览
- **时间线预览**：支持预览部分或全部时间线的动画效果
- **画布编辑器**：提供可视化的动画路径编辑器
- **关键帧预览**：可视化显示动画的关键帧状态

### 实现阶段

1. **阶段一**：基础功能集成（5天）
   - 图片文本编辑功能
   - 基于文本生成音频的基础集成
   - 简单的组合动画参数设置

2. **阶段二**：高级功能实现（7天）
   - 动画效果预览系统
   - 完整的组合动画编辑器
   - 音频与图片时长智能匹配

3. **阶段三**：用户体验优化（3天）
   - 性能优化
   - 界面交互改进
   - 预设模板系统

### 技术实现要点

1. **动画预览**：使用Canvas或WebGL技术实现动画效果预览
2. **音频处理**：集成Web Audio API进行音频预览和处理
3. **状态管理**：扩展现有的Pinia状态管理，支持更复杂的动画参数
4. **API集成**：封装文本转音频的API调用，实现无缝集成

## 结论

本Web UI开发计划旨在为Coze API项目提供一个现代、直观且功能完善的浏览器界面，使用户能够充分利用后端API提供的所有功能。通过清晰的任务分解和开发进度记录，确保项目能按计划完成并满足用户需求。 